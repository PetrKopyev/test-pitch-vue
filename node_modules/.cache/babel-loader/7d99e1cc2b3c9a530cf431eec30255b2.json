{"remainingRequest":"/Users/petrkopev/Work/test-pitch-vue/node_modules/babel-loader/lib/index.js!/Users/petrkopev/Work/test-pitch-vue/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/petrkopev/Work/test-pitch-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/petrkopev/Work/test-pitch-vue/src/views/Catalog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/petrkopev/Work/test-pitch-vue/src/views/Catalog.vue","mtime":1665858113715},{"path":"/Users/petrkopev/Work/test-pitch-vue/babel.config.js","mtime":1664605590676},{"path":"/Users/petrkopev/Work/test-pitch-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/petrkopev/Work/test-pitch-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/petrkopev/Work/test-pitch-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/petrkopev/Work/test-pitch-vue/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IE5hdmJhciBmcm9tICJAL2NvbXBvbmVudHMvTmF2YmFyIjsKaW1wb3J0IHsgbWFwQWN0aW9ucywgbWFwU3RhdGUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IGFwaSBmcm9tICdAL2FwaSc7CmltcG9ydCB7IHNldFRva2VuIH0gZnJvbSAiQC9hcGkvaHR0cENsaWVudCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ2F0YWxvZycsCiAgY29tcG9uZW50czogewogICAgTmF2YmFyCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgIGN1cnJlbnRQYWdlOiAxLAogICAgICBwcm9kdWN0c1BlclBhZ2U6IDUwCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7IC4uLm1hcFN0YXRlKCdwcm9kdWN0cycsIFsndG90YWwnLCAncHJvZHVjdHMnXSkKICB9LAogIG1ldGhvZHM6IHsgLi4ubWFwQWN0aW9ucygncHJvZHVjdHMnLCBbJ2ZldGNoUHJvZHVjdHMnLCAnZmV0Y2hQcm9kdWN0c0NvdW50J10pLAoKICAgIGFzeW5jIGdldFByb2R1Y3RzKG9mZnNldCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsKICAgICAgICBhd2FpdCB0aGlzLmZldGNoUHJvZHVjdHMoewogICAgICAgICAgb2Zmc2V0CiAgICAgICAgfSk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBvblBhZ2VDaGFuZ2UocGFnZSkgewogICAgICBsZXQgb2Zmc2V0VmlldzsKCiAgICAgIGlmIChwYWdlID09PSAxKSB7CiAgICAgICAgb2Zmc2V0VmlldyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2Zmc2V0VmlldyA9IHRoaXMucHJvZHVjdHNQZXJQYWdlICogKHBhZ2UgLSAxKSArIDE7CiAgICAgIH0KCiAgICAgIHRoaXMuZ2V0UHJvZHVjdHMob2Zmc2V0Vmlldyk7CiAgICB9LAoKICAgIGFzeW5jIHRvRmF2b3JpdGUocHJvZHVjdCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsKICAgICAgICBwcm9kdWN0LmlzSW5GYXZvdXJpdGVzID0gdHJ1ZTsKICAgICAgICBzZXRUb2tlbihsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSk7CiAgICAgICAgYXdhaXQgYXBpLnByb2R1Y3RzLnRvRmF2b3JpdGVQcm9kdWN0KHsKICAgICAgICAgICdwcm9kdWN0JzogcHJvZHVjdC5pZAogICAgICAgIH0pOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgbm90RmF2b3VyaXRlKHByb2R1Y3QpIHsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7CiAgICAgICAgcHJvZHVjdC5pc0luRmF2b3VyaXRlcyA9IGZhbHNlOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0UHJvZHVjdHMoKTsKICAgIHRoaXMuZmV0Y2hQcm9kdWN0c0NvdW50KCk7CiAgfQoKfTs="},{"version":3,"mappings":"AAqCA;AACA;AACA;AACA;AAEA;EACAA,eADA;EAEAC;IACAC;EADA,CAFA;;EAKAC;IACA;MACAC,gBADA;MAEAC,cAFA;MAGAC;IAHA;EAKA,CAXA;;EAYAC,YACA;EADA,CAZA;EAeAC,WACA,kEADA;;IAEA;MACA;QACA;QACA;UAAAC;QAAA;MACA,CAHA,SAGA;QACA;MACA;IACA,CATA;;IAUAC;MACA;;MACA;QACAC;MACA,CAFA,MAEA;QACAA;MACA;;MAEA;IACA,CAnBA;;IAoBA;MACA;QACA;QACAC;QACAC;QACA;UAAA;QAAA;MACA,CALA,SAKA;QACA;MACA;IACA,CA7BA;;IA8BAC;MACA;QACA;QACAF;MACA,CAHA,SAGA;QACA;MACA;IACA;;EArCA,CAfA;;EAsDAG;IACA;IACA;EACA;;AAzDA","names":["name","components","Navbar","data","isLoading","currentPage","productsPerPage","computed","methods","offset","onPageChange","offsetView","product","setToken","notFavourite","created"],"sourceRoot":"src/views","sources":["Catalog.vue"],"sourcesContent":["<template>\n  <div>\n    <Navbar/>\n\n    <div class=\"products container\">\n      <h1 class=\"products-title\">Список товаров</h1>\n      <div\n          v-loading=\"isLoading\"\n      >\n\n      </div>\n      <div\n          v-for=\"product in products\"\n          :key=\"product.id\"\n          class=\"products-list\"\n      >\n        <span>{{ product.title }}</span>\n        <el-button v-if=\"!product.isInFavourites\" icon=\"el-icon-star-off\" @click=\"toFavorite(product)\"></el-button>\n        <el-button v-else icon=\"el-icon-star-on\" @click=\"notFavourite(product)\"></el-button>\n      </div>\n      <div\n          class=\"products-pagination\"\n      >\n        <el-pagination\n            background\n            layout=\"prev, pager, next\"\n            :current-page.sync=\"currentPage\"\n            :total=\"total\"\n            :page-size=\"productsPerPage\"\n            @current-change=\"onPageChange\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Navbar from \"@/components/Navbar\";\nimport {mapActions, mapState} from 'vuex';\nimport api from '@/api'\nimport {setToken} from \"@/api/httpClient\";\n\nexport default {\n  name: 'Catalog',\n  components: {\n    Navbar\n  },\n  data() {\n    return {\n      isLoading: false,\n      currentPage: 1,\n      productsPerPage: 50,\n    }\n  },\n  computed: {\n    ...mapState('products', ['total', 'products']),\n  },\n  methods: {\n    ...mapActions('products', ['fetchProducts', 'fetchProductsCount']),\n    async getProducts(offset) {\n      try {\n        this.isLoading = true;\n        await this.fetchProducts({offset});\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    onPageChange(page) {\n      let offsetView\n      if (page === 1) {\n        offsetView = 0\n      } else {\n        offsetView = this.productsPerPage * (page - 1) + 1\n      }\n\n      this.getProducts(offsetView);\n    },\n    async toFavorite(product) {\n      try {\n        this.isLoading = true;\n        product.isInFavourites = true\n        setToken(localStorage.getItem('token'))\n        await api.products.toFavoriteProduct({'product': product.id})\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    notFavourite(product) {\n      try {\n        this.isLoading = true;\n        product.isInFavourites = false\n      } finally {\n        this.isLoading = false;\n      }\n    }\n  },\n  created() {\n    this.getProducts()\n    this.fetchProductsCount()\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.products {\n  margin-top: 20px;\n\n  &-title {\n    margin-bottom: 25px;\n    text-align: center;\n  }\n\n  &-list {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 7px;\n    padding: 5px 20px;\n    border: 1px solid sandybrown;\n    border-radius: 10px;\n\n    & .el-button {\n      font-size: 30px;\n      padding: 1px;\n      border-radius: 26px;\n    }\n  }\n\n  &-pagination {\n    margin: 30px 0 70px;\n    display: flex;\n    justify-content: center;\n  }\n}\n</style>\n"]}]}