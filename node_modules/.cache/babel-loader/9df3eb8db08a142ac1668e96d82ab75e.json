{"remainingRequest":"/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/babel-loader/lib/index.js!/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/petrkopev/Desktop/work/test-pitch-vue/src/views/Favourites.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/petrkopev/Desktop/work/test-pitch-vue/src/views/Favourites.vue","mtime":1665729081545},{"path":"/Users/petrkopev/Desktop/work/test-pitch-vue/babel.config.js","mtime":1664605590676},{"path":"/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/petrkopev/Desktop/work/test-pitch-vue/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IE5hdmJhciBmcm9tICJAL2NvbXBvbmVudHMvTmF2YmFyIjsKaW1wb3J0IHsgbWFwQWN0aW9ucywgbWFwU3RhdGUgfSBmcm9tICd2dWV4JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdGYXZvdXJpdGVzJywKICBjb21wb25lbnRzOiB7CiAgICBOYXZiYXIKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgY3VycmVudFBhZ2U6IDEsCiAgICAgIGZhdm91cml0ZXNQZXJQYWdlOiA1MAogICAgfTsKICB9LAoKICBjb21wdXRlZDogeyAuLi5tYXBTdGF0ZSgnZmF2b3VyaXRlcycsIFsndG90YWwnLCAnZmF2b3VyaXRlcyddKQogIH0sCiAgbWV0aG9kczogeyAuLi5tYXBBY3Rpb25zKCdmYXZvdXJpdGVzJywgWydmZXRjaEZhdm91cml0ZXMnLCAnZmV0Y2hGYXZvdXJpdGVzQ291bnQnLCAnZGVsZXRlRmF2b3VyaXRlJ10pLAoKICAgIGFzeW5jIGdldEZhdm91cml0ZXMob2Zmc2V0KSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hGYXZvdXJpdGVzKHsKICAgICAgICAgIG9mZnNldAogICAgICAgIH0pOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCgogICAgb25QYWdlQ2hhbmdlKHBhZ2UpIHsKICAgICAgbGV0IG9mZnNldFZpZXc7CgogICAgICBpZiAocGFnZSA9PT0gMSkgewogICAgICAgIG9mZnNldFZpZXcgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIG9mZnNldFZpZXcgPSB0aGlzLmZhdm91cml0ZXNQZXJQYWdlICogKHBhZ2UgLSAxKSArIDE7CiAgICAgIH0KCiAgICAgIHRoaXMuZ2V0RmF2b3VyaXRlcyhvZmZzZXRWaWV3KTsKICAgIH0sCgogICAgYXN5bmMgb25EZWxldGVGYXZvdXJpdGUoaWQpIHsKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7CiAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVGYXZvdXJpdGUoewogICAgICAgICAgaWQKICAgICAgICB9KTsKICAgICAgICBhd2FpdCB0aGlzLmdldEZhdm91cml0ZXMoKTsKICAgICAgICBhd2FpdCB0aGlzLmZldGNoRmF2b3VyaXRlc0NvdW50KCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGUpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0RmF2b3VyaXRlcygpOwogICAgdGhpcy5mZXRjaEZhdm91cml0ZXNDb3VudCgpOwogIH0KCn07"},{"version":3,"mappings":"AA2CA;AACA;AAGA;EACAA,kBADA;EAEAC;IACAC;EADA,CAFA;;EAKAC;IACA;MACAC,gBADA;MAEAC,cAFA;MAGAC;IAHA;EAKA,CAXA;;EAYAC,YACA;EADA,CAZA;EAeAC,WACA,2FADA;;IAEA;MACA;QACA;QAEA;UAAAC;QAAA;MACA,CAJA,SAIA;QACA;MACA;IACA,CAVA;;IAWAC;MACA;;MACA;QACAC;MACA,CAFA,MAEA;QACAA;MACA;;MAEA;IACA,CApBA;;IAsBA;MACA;QACA;QACA;UAAAC;QAAA;QACA;QACA;MACA,CALA,CAKA;QACAC;MACA,CAPA,SAOA;QACA;MACA;IACA;;EAjCA,CAfA;;EAkDAC;IACA;IACA;EAEA;;AAtDA","names":["name","components","Navbar","data","isLoading","currentPage","favouritesPerPage","computed","methods","offset","onPageChange","offsetView","id","console","created"],"sourceRoot":"src/views","sources":["Favourites.vue"],"sourcesContent":["<template>\n  <div>\n    <Navbar/>\n\n    <div\n        v-loading=\"isLoading\"\n        class=\"favourites container\"\n    >\n      <h1 class=\"favourites-title\">Избранное</h1>\n      <div\n          v-for=\"favourite in favourites\"\n          :key=\"favourite.id\"\n          class=\"favourites-list\"\n      >\n        <span class=\"favourites-item\">{{ favourite.product.title }}</span>\n        <el-popconfirm\n            title=\"Вы уверены, что хотите удалить?\"\n            @confirm=\"onDeleteFavourite(favourite.product.id)\"\n        >\n          <el-button\n              slot=\"reference\"\n              type=\"outline-primary\"\n              icon=\"el-icon-star-on\"\n          >\n          </el-button>\n        </el-popconfirm>\n      </div>\n\n      <div class=\"favourites-pagination\">\n        <el-pagination\n            background\n            layout=\"prev, pager, next\"\n            :current-page.sync=\"currentPage\"\n            :total=\"total\"\n            :page-size=\"favouritesPerPage\"\n            @current-change=\"onPageChange\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Navbar from \"@/components/Navbar\";\nimport {mapActions, mapState} from 'vuex';\n\n\nexport default {\n  name: 'Favourites',\n  components: {\n    Navbar\n  },\n  data() {\n    return {\n      isLoading: false,\n      currentPage: 1,\n      favouritesPerPage: 50,\n    }\n  },\n  computed: {\n    ...mapState('favourites', ['total', 'favourites']),\n  },\n  methods: {\n    ...mapActions('favourites', ['fetchFavourites', 'fetchFavouritesCount', 'deleteFavourite']),\n    async getFavourites(offset) {\n      try {\n        this.isLoading = true;\n\n        await this.fetchFavourites({offset});\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    onPageChange(page) {\n      let offsetView\n      if (page === 1) {\n        offsetView = 0\n      } else {\n        offsetView = this.favouritesPerPage * (page - 1) + 1\n      }\n\n      this.getFavourites(offsetView);\n    },\n\n    async onDeleteFavourite(id) {\n      try {\n        this.isLoading = true;\n        await this.deleteFavourite({id});\n        await this.getFavourites()\n        await this.fetchFavouritesCount()\n      } catch (e) {\n        console.error(e);\n      } finally {\n        this.isLoading = false;\n      }\n    },\n  },\n  created() {\n    this.getFavourites()\n    this.fetchFavouritesCount()\n\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.favourites {\n  margin-top: 20px;\n\n  &-title {\n    margin-bottom: 25px;\n    text-align: center;\n  }\n\n  &-list {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 7px;\n    padding: 5px 20px;\n    border: 1px solid sandybrown;\n    border-radius: 10px;\n\n    & .el-button {\n      font-size: 30px;\n      padding: 1px;\n      border-radius: 26px;\n    }\n  }\n\n  &-pagination {\n    margin: 30px 0 70px;\n    display: flex;\n    justify-content: center;\n  }\n}\n</style>\n"]}]}